---
layout: base_slides
logo: "GTN"

title: "Storage Management"
questions:
- How does Galaxy locate data?
- How can I have Galaxy use multiple storage locations?
objectives:
- Setup Galaxy with both the Hierarachical and Distributed Object Storages
key_points:
- The distributed object store configuration allows you to easily expand that storage that is attached to your Galaxy.
- You can move data around without affecting users.
contributors:
  - natefoo
  - martenson
  - hexylena
---

class: normal
# Mechanics

* When files are produced they are stored in the filesystem defined by `file_path` config in `galaxy.yml`.
  * Defaults to `database/files`.

--
*  A database entry in `Dataset` table is created.
  * Among others it has:  `| id	| deleted	| purged | file_size |`

--
* To user we present the data through:
  * Entries in `HistoryDatasetAssociation` table.
    * Among others it has:  `| id	| history_id | deleted	| dataset_id |`
  * Entries in `LibraryDatasetDatasetAssociation` table.
    * Among others it has:  `| id	| library_dataset_id | deleted	| dataset_id |`

--
Any number of 'Association' records can point to a base Dataset -- this is how copying histories, history items, and libraries work without needing to copy actual file contents.

---
# Object Store Plugins

Direct:
- Disk
- Amazon S3/OpenStack Swift
- Experimental
  - Azure
  - CloudBridge â†’ S3, Swift, Azure, GCE

---

# Object Storage Strategies

.pull-left[
**Hierarchical**

- Choose between options based on priority
- Always uses first (unless max_pct_full + too full)

]

.pull-right[
**Distributed**

- Randomly choose between several storage options
- Can fill up at same rate, or different (weighting)
]
