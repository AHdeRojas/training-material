<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>External Authentication</title>
        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-45719423-18' , 'auto');
            ga('send', 'pageview');
        </script>
        
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <link rel="stylesheet" href="/training-material/assets/css/font-awesome.css">
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />

        
        
        
        
        
        <meta name="description" content="Resources related to configuration and maintenance of Gal..." />
        <meta property="og:title" content="Galaxy Training: External Authentication" />
        <meta property="og:description" content="Resources related to configuration and maintenance of Gal..." />
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    </head>
    <body data-spy="scroll" data-target="#toc">
        





<header>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/topics/admin" title="Go back to list of tutorials">
                            <i class="fa fa-folder-o" aria-hidden="true"></i><span class="visually-hidden">topic</span> Galaxy Server administration
                        </a>
                    </li>

                    
                    
                    

                    
                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/topics/admin/tutorials/external-auth/slides.html" title="Slides for this tutorial">
                            <i class="fa fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> Associated slides
                        </a>
                    </li>
                    

                    
                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
                                <i class="fa fa-cog" aria-hidden="true"></i><span class="visually-hidden">instances</span> Galaxy Instances
                            </a>
                            <div class="dropdown-menu">
                                
                                    <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/master/topics/admin/docker" title="Docker image for this tutorial">
                                        <i class="fa fa-ship" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
                                    </a>
                                
                                
                                
                            </div>
                        </li>
                    

                    

                    
                    <li class="nav-item">
                        <a class="nav-link" href="" title="Links to data">
                            <i class="fa fa-files-o" aria-hidden="true"></i><span class="visually-hidden">zenodo_link</span> Input Dataset
                        </a>
                    </li>
                    

                    

                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="EN">
                            EN
                        </a>
                        <div class="dropdown-menu">
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=fr&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fadmin%2Ftutorials%2Fexternal-auth%2Ftutorial.html&edit-text=&act=url" title="">
                                FR
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ja&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fadmin%2Ftutorials%2Fexternal-auth%2Ftutorial.html&edit-text=&act=url" title="">
                                JA
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=es&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fadmin%2Ftutorials%2Fexternal-auth%2Ftutorial.html&edit-text=&act=url" title="">
                                ES
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=pt&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fadmin%2Ftutorials%2Fexternal-auth%2Ftutorial.html&edit-text=&act=url" title="">
                                PT
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ar&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fadmin%2Ftutorials%2Fexternal-auth%2Ftutorial.html&edit-text=&act=url" title="">
                                AR
                            </a>
                            
                        </div>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="fa fa-life-ring" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>

        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQ">
            FAQ
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Chat on Gitter">
            Chat on Gitter
        </a>
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            Discuss on Galaxy Help
        </a>
    </div>
</li>


                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/galaxyproject/training-material/edit/master/topics/admin/tutorials/external-auth/tutorial.md">
                            <i class="fa fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="container main-content">
    <script type="application/ld+json">
        


{
  "@context": "http://schema.org",
  "@type": "Course",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "Short descriptions are present but long descriptions will be needed for non-visual users",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "External Authentication",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "license": "/blob//LICENSE.md",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "courseCode": "admin / external-auth / hands-on",
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'External Authentication' tutorial",
  "isPartOf": {
    "@type": "Course",
    "name": "External Authentication",
    "description": "External Authentication",
    "learningResourceType": "tutorial",
    "interactivityType": "expositive",
    "provider": {
      "@type": "Organization",
      "email": "galaxytrainingnetwork@gmail.com",
      "name": "Galaxy Training Network",
      "url": "https://galaxyproject.org/teach/gtn/"
    }
  },
  "url": "https://galaxyproject.github.io//training-material/topics/admin/tutorials/external-auth/tutorial.html",
  "timeRequired": "PT30M",
  "keywords": "ansible",
  "description": "External Authentication\\nThe questions this  addresses are:\n - How can I connect Galaxy with CAS, SAML, etc.\n\n\\nThe objectives are:\n - be familiar with configuring Galaxy to use an upstream (proxy) authentication provider\n - be able to log in to your Galaxy server with a file-configured user.\n\n",
  "coursePrerequisites": [
    {
      "@type": "Course",
      "url": "https://galaxyproject.github.io//training-material/topics/admin/tutorials/ansible/slides.html",
      "name": "Ansible",
      "description": "Slides for 'Ansible' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://galaxyproject.github.io//training-material/topics/admin/tutorials/ansible/tutorial.html",
      "name": "Ansible",
      "description": "Hands-on for 'Ansible' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://galaxyproject.github.io//training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html",
      "name": "Galaxy Installation with Ansible",
      "description": "Hands-on for 'Galaxy Installation with Ansible' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "hasPart": [

  ],
  "mentions": [

  ],
  "author": [
    {
      "@type": "Person",
      "name": "Nate Coraor"
    },
    {
      "@type": "Person",
      "name": "Nicola Soranzo"
    },
    {
      "@type": "Person",
      "name": "Helena Rasche"
    }
  ],
  "contributor": [
    {
      "@type": "Person",
      "name": "Nate Coraor"
    },
    {
      "@type": "Person",
      "name": "Nicola Soranzo"
    },
    {
      "@type": "Person",
      "name": "Helena Rasche"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Galaxy Server administration",
      "description": "Resources related to configuration and maintenance of Galaxy servers",
      "url": "https://galaxyproject.github.io//training-material/topics/admin/"
    }
  ]
}
    </script>

    <section class="tutorial">
        <h1 data-toc-skip>External Authentication</h1>
        <div class="contributors-line">By: 

<a href="/training-material/hall-of-fame#natefoo" class="contributor-badge"><img src="https://avatars.githubusercontent.com/natefoo" alt="Nate Coraor">Nate Coraor</a>, <a href="/training-material/hall-of-fame#nsoranzo" class="contributor-badge"><img src="https://avatars.githubusercontent.com/nsoranzo" alt="Nicola Soranzo">Nicola Soranzo</a>, <a href="/training-material/hall-of-fame#erasche" class="contributor-badge"><img src="https://avatars.githubusercontent.com/erasche" alt="Helena Rasche">Helena Rasche</a>

</div>
        <blockquote class="overview">
            <h3>Overview</h3>

            <strong><i class="fa fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</strong>
            <ul>
            
            <li>How can I connect Galaxy with CAS, SAML, etc.</li>
            
            </ul>

            <strong><i class="fa fa-bullseye" aria-hidden="true"></i><span class="visually-hidden">objectives</span> Objectives</strong>
            <ul>
            
            <li>be familiar with configuring Galaxy to use an upstream (proxy) authentication provider</li>
            
            <li>be able to log in to your Galaxy server with a file-configured user.</li>
            
            </ul>

            
            <strong><i class="fa fa-check-circle" aria-hidden="true"></i><span class="visually-hidden">requirements</span> Requirements</strong>
            <ul>
            
            
    <li>
    
        
        
        <a href="/training-material/topics/admin">Galaxy Server administration</a>
        
            <ul>
                
                    
                        
                    
                        
                    
                        
                            
                            <li> Ansible:
                            
                                <a href="/training-material/topics/admin/tutorials/ansible/slides.html"><i class="fa fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides</a>
                                
                            
                            
                                
                                    - <a href="/training-material/topics/admin/tutorials/ansible/tutorial.html"><i class="fa fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                            <li> Galaxy Installation with Ansible:
                            
                            
                                
                                     <a href="/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html"><i class="fa fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                
            </ul>
        
    
    </li>

            </ul>
            

            
            <p><strong><i class="fa fa-hourglass-end" aria-hidden="true"></i><span class="visually-hidden">time</span> Time estimation:</strong> 30 minutes</p>
            
        </blockquote>

        <div class="container">
            <div class="row">
                <!-- sidebar, which will move to the top on a small screen -->
                <div class="col-sm-2">
                    <nav id="toc" data-toggle="toc" class="sticky-top"></nav>
                </div>
                <div class="col-sm-10">
                    <h1 class="no_toc" id="overview">Overview</h1>

<p>For this exercise we will use a basic password file method for authenticating - this is probably not a very useful method in production, but it demonstrates how the proxy server can be configured to provide the correct header to Galaxy, and how Galaxy integrates with upstream authentication providers. This same method can be used with NGINX and Apache modules for CAS or SAML authentication.</p>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

<ol id="markdown-toc">
  <li><a href="#configuring-authentication" id="markdown-toc-configuring-authentication">Configuring Authentication</a></li>
  <li><a href="#testing" id="markdown-toc-testing">Testing</a></li>
  <li><a href="#api-access" id="markdown-toc-api-access">API access</a></li>
  <li><a href="#reverting" id="markdown-toc-reverting">Reverting</a></li>
</ol>

</blockquote>

<h1 id="configuring-authentication">Configuring Authentication</h1>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-configuring-everything"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Configuring everything</h3>

  <ol>
    <li>Edit your <code class="highlighter-rouge">galaxyservers</code> group variables file and update the main location block defined for serving galaxy. Add the parameters:
      <ul>
        <li><code class="highlighter-rouge">auth_basic galaxy;</code></li>
        <li><code class="highlighter-rouge">auth_basic_user_file /etc/nginx/passwd;</code></li>
        <li><code class="highlighter-rouge">uwsgi_param HTTP_REMOTE_USER $reomte_user;</code></li>
      </ul>

      <p>It should look like:</p>

      <div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">location</span> <span class="n">/</span> <span class="p">{</span>
        <span class="kn">uwsgi_pass</span>           <span class="nf">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
        <span class="kn">uwsgi_param</span>          <span class="s">UWSGI_SCHEME</span> <span class="nv">$scheme</span><span class="p">;</span>
        <span class="kn">include</span>              <span class="s">uwsgi_params</span><span class="p">;</span>
        <span class="kn">auth_basic</span>           <span class="s">galaxy</span><span class="p">;</span>
        <span class="kn">auth_basic_user_file</span> <span class="n">/etc/nginx/passwd</span><span class="p">;</span>
        <span class="kn">uwsgi_param</span>          <span class="s">HTTP_REMOTE_USER</span> <span class="nv">$remote_user</span><span class="p">;</span>
        <span class="kn">uwsgi_param</span>          <span class="s">HTTP_GX_SECRET</span> <span class="s">SOME_SECRET_STRING</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div>      </div>

      <p><code class="highlighter-rouge">auth_basic</code> enables validation of username and password using the “HTTP Basic Authentication” protocol. Its value <code class="highlighter-rouge">galaxy</code> is used as a realm name to be displayed to the user when prompting for credentials.
<code class="highlighter-rouge">auth_basic_user_file</code> specifies the file that keeps usernames and passwords.
<code class="highlighter-rouge">uwsgi_param</code> adds <code class="highlighter-rouge">HTTP_REMOTE_USER</code> to the special variables passed by nginx to uwsgi, with value <code class="highlighter-rouge">$remote_user</code>, which is a nginx embedded variable containing the username supplied with the Basic authentication.</p>

      <p><code class="highlighter-rouge">GX_SECRET</code> is added as a header for security purposes, to prevent any other users on the system impersonating nginx and sending requests to Galaxy. NGINX and other webservers like Apache will strip any user-sent <code class="highlighter-rouge">REMOTE_USER</code> headers, as that header defines the authenticated user. If you can talk directly to Galaxy (e.g. via curl) and provide the <code class="highlighter-rouge">REMOTE_USER</code> header, you can impersonate any other use. While having Galaxy listen on <code class="highlighter-rouge">127.0.0.1</code> prevents any requests from outside of the system reaching Galaxy, anyone on the system can still send requests to that port. Here you can choose to switch to a unix socket with permissions only permitting Galaxy and Nginx to connect. For using sockets, we ins</p>
    </li>
    <li>
      <p>Add a pre_task using the <a href="https://docs.ansible.com/ansible/latest/modules/pip_module.html"><code class="highlighter-rouge">pip</code></a> module which installs the library <code class="highlighter-rouge">passlib</code>, which is required for <code class="highlighter-rouge">htpasswd</code>.</p>

      <p>Add a pre_task using the <a href="https://docs.ansible.com/ansible/2.4/htpasswd_module.html"><code class="highlighter-rouge">htpasswd</code></a> module which sets up a password file in <code class="highlighter-rouge">/etc/nginx/passwd</code>, with owner and group set to root, and a name and password, and a mode of 0640.</p>
      <blockquote class="question">
        <h3 id="question-question"><i class="fa fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Question</h3>

        <p>How does your final configuration look?</p>

        <blockquote class="solution">
          <h3 id="solution-solution"><i class="fa fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>

          <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- pip:
    name: passlib
- htpasswd:
    path: /etc/nginx/passwd
    name: helena                    # Pick a username
    password: 'squeamish ossifrage' # and a password
    owner: www-data # nginx on centos
    group: root
    mode: 0640
</code></pre></div>          </div>
        </blockquote>

      </blockquote>
    </li>
    <li>
      <p>Galaxy needs to be instructed to expect authentication to come from the upstream proxy. In order to do this, set the following two options in your Galaxy group variables:</p>

      <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">...</span>
<span class="na">galaxy_config</span><span class="pi">:</span>
  <span class="na">galaxy</span><span class="pi">:</span>
    <span class="s">...</span>
    <span class="s">use_remote_user</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">remote_user_maildomain</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
    <span class="na">remote_user_secret</span><span class="pi">:</span> <span class="s">SOME_SECRET_STRING</span>
</code></pre></div>      </div>

      <p>Set the <code class="highlighter-rouge">remote_user_maildomain</code> option to the appropriate domain name for your site.</p>
    </li>
    <li>Run the playbook</li>
  </ol>

</blockquote>

<blockquote class="comment">
  <h3 id="comment-access-denied"><i class="fa fa-commenting-o" aria-hidden="true"></i><span class="visually-hidden">comment</span> Access denied</h3>

  <p>If you see this message, it is because nginx is not correctly sending the <code class="highlighter-rouge">REMOTE_USER</code> or the <code class="highlighter-rouge">GX_SECRET</code> values.</p>

  <p><img src="../../images/access_denied.png" alt="access denied message" /></p>

</blockquote>

<h1 id="testing">Testing</h1>

<p>You should now be presented with a password dialog when attempting to load the Galaxy UI.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-testing"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Testing</h3>

  <ol>
    <li>
      <p>Log in using the username and password you provided when creating the <code class="highlighter-rouge">passwd</code> file. If your username and the value of <code class="highlighter-rouge">remote_user_maildomain</code> match an existing user, you will be logged in to that account. If not, a new account will be created for that user.</p>
    </li>
    <li>
      <p>Click on the “User” menu at the top, to see how the username appears.</p>
    </li>
    <li>
      <p>Note that some user features are not available when remote user support is enabled.</p>

      <p>Try logging out by selecting <strong>User</strong> -&gt; <strong>Logout</strong>. You will discover that when returning to the user interface, you are still logged in. This is because Galaxy has no way of logging you out of the proxy’s authentication system. Instead, you should set <code class="highlighter-rouge">remote_user_logout_href</code> in <code class="highlighter-rouge">galaxy.yml</code> to point to the URL of your authentication system’s logout page.</p>
    </li>
  </ol>

</blockquote>

<h1 id="api-access">API access</h1>

<p>If you wish your Galaxy to be accessible to command line clients (e.g. bioblend, blend4j, parsec), you will need to add an exception for authentication on the API. Galaxy will still be secure and protected, but non-browser access will be permitted with an API key.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>location /api/ {
    satisfy any;
    allow all;
}
</code></pre></div></div>

<h1 id="reverting">Reverting</h1>

<p>We don’t want to leave Galaxy this way for the rest of our workshop.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-reverting-the-changes"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Reverting the changes</h3>

  <ol>
    <li>
      <p>Edit your group variables file and comment out:</p>

      <ul>
        <li>the NGINX changes</li>
        <li><code class="highlighter-rouge">use_remote_user: true</code></li>
      </ul>
    </li>
    <li>
      <p>Run the playbook</p>
    </li>
  </ol>

</blockquote>



                    
                    <blockquote class="key_points">
                        <h3><i class="fa fa-key" aria-hidden="true"></i><span class="visually-hidden">keypoints</span> Key points</h3>

                        <ul>
                            
                            <li>Remote auth is not complex to set up and can help you meet institutional requirements</li>
                            
                        </ul>
                    </blockquote>
                    

                    

                    

                </div>
            </div>
        </div>

        <h3><i class="fa fa-thumbs-up" aria-hidden="true"></i><span class="visually-hidden">congratulations</span> Congratulations on successfully completing this tutorial!</h3>

        

        

        <hr>
        <br>

        <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=External Authentication (Galaxy Server administration)">Loading...
        </iframe>

        <blockquote class="feedback">
            <h3><i class="fa fa-comments-o" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Give us even more feedback on this content!</h3>
            <p>To give us more detailed feedback about these materials, please take a moment to fill in the extended <a href="https://docs.google.com/forms/d/e/1FAIpQLSc_GLZRpxZGAL9tN6DA1bE6WkNhmQdXT7B16TpOb-X4YwKUsQ/viewform?entry.1548889262=External Authentication (Galaxy Server administration)">Feedback Form</a>.</p>
        </blockquote>
    </section>
</div>


<footer>
    <div class="container">
        <p>
            This material is the result of a collaborative work. Thanks to the
            <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a>
            and all the <a href="/training-material/hall-of-fame">contributors</a> ({"a-asai"=>{"name"=>"Atsushi Asai""email"=>"tbudcm7zk@i.softbank.jp"}, "abretaud"=>{"name"=>"Anthony Bretaudeau", "email"=>"anthony.bretaudeau@inra.fr", "twitter"=>"abretau", "gitter"=>"abretaud", "orcid"=>"0000-0003-0914-2470"}, "abdulrahmanazab"=>{"name"=>"Abdulrahman Azab"}, "afgane"=>{"name"=>"Enis Afgan"}, "aisanjiangw"=>{"name"=>"Aisanjiang Wubuli"}, "andreasrichter"=>{"name"=>"Andreas Richter", "github"=>false}, "annatrigos"=>{"name"=>"Anna Trigos", "github"=>false}, "andrewjpage"=>{"name"=>"Andrew Page", "email"=>"andrewjpage@gmail.com", "twitter"=>"andrewjpage", "orcid"=>"0000-0001-6919-6062"}, "annasyme"=>{"name"=>"Anna Syme"}, "anuprulez"=>{"name"=>"Anup Kumar", "email"=>"anup.rulez@gmail.com", "twitter"=>"musafirtweetsz"}, "baberlevi"=>{"name"=>"Levi Baber"}, "bagnacan"=>{"name"=>"Andrea Bagnacani", "email"=>"andrea.bagnacani@gmail.com"}, "bebatut"=>{"name"=>"Bérénice Batut", "email"=>"berenice.batut@gmail.com", "twitter"=>"bebatut", "linkedin"=>"berenicebatut", "gitter"=>"bebatut", "orcid"=>"0000-0001-9852-1987"}, "bernt-matthias"=>{"name"=>"Matthias Bernt"}, "bgruening"=>{"name"=>"Björn Grüning", "email"=>"bjoern.gruening@gmail.com", "twitter"=>"bjoerngruening", "gitter"=>"bgruening", "orcid"=>"0000-0002-3079-6586", "linkedin"=>"bgruening"}, "blankclemens"=>{"name"=>"Clemens Blank", "email"=>"blankclemens@gmail.com"}, "blankenberg"=>{"name"=>"Daniel Blankenberg", "twitter"=>"dblankenberg", "orcid"=>"0000-0002-6833-9049"}, "bphipson"=>{"name"=>"Belinda Phipson"}, "cecilecanlet"=>{"name"=>"Cécile Canlet", "github"=>false}, "charitylaw"=>{"name"=>"Charity Law"}, "cicozhang"=>{"name"=>"Chao (Cico) Zhang", "maintainer_contact"=>"https://hi-it.org", "twitter"=>"CicoCN"}, "claresloggett"=>{"name"=>"Clare Sloggett"}, "cmonjeau"=>{"name"=>"Cyril Monjeaud"}, "cganote"=>{"name"=>"Carrie Ganote"}, "daltis20012009"=>{"name"=>"Krzys Poterlowicz", "github"=>false}, "dannon"=>{"name"=>"Dannon Baker"}, "delphine-l"=>{"name"=>"Delphine Lariviere", "email"=>"delphine.lariviere@galaxy.org"}, "dmaticzka"=>{"name"=>"Daniel Maticzka"}, "dpryan79"=>{"name"=>"Devon Ryan"}, "dsobral"=>{"name"=>"Daniel Sobral"}, "SanneAbeln"=>{"name"=>"Sanne Abeln"}, "dyusuf"=>{"name"=>"Dilmurat Yusuf"}, "erasche"=>{"name"=>"Helena Rasche", "email"=>"hxr@hx42.org", "orcid"=>"0000-0001-9760-8992"}, "erxleben"=>{"name"=>"Anika Erxleben", "email"=>"anikaerxleben@gmail.com", "orcid"=>"0000-0002-7427-6478"}, "fabio-cumbo"=>{"name"=>"Fabio Cumbo", "email"=>"fabio.cumbo@gmail.com", "twitter"=>"cumbofabio", "linkedin"=>"fabiocumbo", "gitter"=>"fabio-cumbo", "orcid"=>"0000-0003-2920-5838"}, "fidelram"=>{"name"=>"Fidel Ramirez"}, "Florian-H-Lab"=>{"name"=>"Florian Heyl"}, "foellmelanie"=>{"name"=>"Melanie Foell"}, "fmareuil"=>{"name"=>"Fabien Mareuil"}, "frederikcoppens"=>{"name"=>"Frederik Coppens"}, "friedue"=>{"name"=>"Friederike Dündar"}, "gmauro"=>{"name"=>"Gianmauro Cuccuru"}, "guerler"=>{"name"=>"Aysam Guerler"}, "hdashnow"=>{"name"=>"Harriet Dashnow"}, "hmenager"=>{"name"=>"Hervé Ménager"}, "hrhotz"=>{"name"=>"Hans-Rudolf Hotz", "email"=>"hrhotz@googlemail.com", "twitter"=>"hrhotz", "gitter"=>"hrhotz", "orcid"=>"0000-0002-2799-424X", "linkedin"=>"hans-rudolf-hotz-542b31"}, "igcbioinformatics"=>{"name"=>"IGC Bioinformatics Unit"}, "jennaj"=>{"name"=>"Jennifer Hillman-Jackson", "maintainer_contact"=>"https://biostar.usegalaxy.org", "email"=>"jen@galaxyproject.org", "gitter"=>"jennaj", "twitter"=>"jenhjackson", "linkedin"=>"jennifer.hillman.jackson", "orcid"=>"0000-0003-4012-8116"}, "jennydg"=>{"name"=>"Jennifer Del Giudice"}, "jfallmann"=>{"name"=>"Joerg Fallmann"}, "jgoecks"=>{"name"=>"Jeremy Goecks"}, "jj-umn"=>{"name"=>"James Johnson", "email"=>"jj@umn.edu"}, "jmchilton"=>{"name"=>"John Chilton", "email"=>"jmchilton@gmail.com"}, "joachimwolff"=>{"name"=>"Joachim Wolff", "email"=>"wolffj@informatik.uni-freiburg.de"}, "JovMaksimovic"=>{"name"=>"Jovana Maksimovic"}, "jpmaree"=>nil, "jraysajulga"=>{"name"=>"Ray Sajulga", "email"=>"rsajulga@umn.edu"}, "jxtx"=>{"name"=>"James Taylor"}, "katrinleinweber"=>{"name"=>"Katrin Leinweber", "email"=>"katrin.leinweber@tib.eu", "orcid"=>"0000-0001-5135-5758"}, "lecorguille"=>{"name"=>"Gildas Le Corguillé"}, "LeilyR"=>{"name"=>"Leily Rabbani"}, "loraine-gueguen"=>{"name"=>"Loraine Guéguen"}, "kilpert"=>{"name"=>"Fabian Kilpert"}, "kpbioteam"=>{"name"=>"Katarzyna Murat"}, "kpoterlowicz"=>{"name"=>"Krzysztof Poterlowicz"}, "malloryfreeberg"=>{"name"=>"Mallory Freeberg"}, "manabuishii"=>{"name"=>"Manabu ISHII"}, "martenson"=>{"name"=>"Martin Čech", "email"=>"marten@bx.psu.edu"}, "marziacremona"=>{"name"=>"Marzia A Cremona", "email"=>"mac78@psu.edu"}, "matthias313"=>{"name"=>"Matthias"}, "mblue9"=>{"name"=>"Maria Doyle"}, "mccalluc"=>{"name"=>"Chuck McCallum"}, "moffmade"=>{"name"=>"Cory Maughmer"}, "moheydarian"=>{"name"=>"Mo Heydarian", "email"=>"mheydarian@gmail.com"}, "mritchie"=>{"name"=>"Matt Ritchie"}, "mtekman"=>{"name"=>"Mehmet Tekman"}, "mvdbeek"=>{"name"=>"Marius van den Beek"}, "mwolfien"=>{"name"=>"Markus Wolfien"}, "natefoo"=>{"name"=>"Nate Coraor", "gitter"=>"natefoo", "twitter"=>"natefoo", "email"=>"nate@bx.psu.edu"}, "nekrut"=>{"name"=>"Anton Nekrutenko", "email"=>"anton@nekrut.org"}, "nicherndon"=>{"name"=>"Nic Herndon"}, "NickSto"=>{"name"=>"Nick Stoler", "twitter"=>"NickStoler"}, "nsoranzo"=>{"name"=>"Nicola Soranzo"}, "nvk747"=>{"name"=>"Vijay"}, "odoppelt"=>{"name"=>"Olivia Doppelt-Azeroual"}, "pajanne"=>{"name"=>"Anne Pajon"}, "pavanvidem"=>{"name"=>"Pavankumar Videm"}, "polkhe"=>{"name"=>"Ekaterina Polkh"}, "pratikdjagtap"=>{"name"=>"Pratik Jagtap", "email"=>"pjagtap@umn.edu"}, "pravs3683"=>{"name"=>"Praveen Kumar", "email"=>"kumar207@umn.edu"}, "pvanheus"=>{"name"=>"Peter van Heusden"}, "reginaesinamabotsi"=>{"name"=>"Regina Esinam Abotsi"}, "sanneabeln"=>{"name"=>"Sanne Abeln"}, "sarah-peter"=>{"name"=>"Sarah Peter"}, "Shians"=>{"name"=>"Shian Su"}, "shiltemann"=>{"name"=>"Saskia Hiltemann", "maintainer_contact"=>"gitter", "email"=>"saskia.hiltemann@gmail.com", "twitter"=>"shiltemann", "linkedin"=>"shiltemann", "gitter"=>"shiltemann", "orcid"=>"0000-0003-3803-468X"}, "slegras"=>{"name"=>"Stéphanie Legras"}, "slugger70"=>{"name"=>"Simon Gladman", "email"=>"simon.gladman@unimelb.edu.au"}, "stortebecker"=>{"name"=>"Florian Christoph Sigloch", "email"=>"sigloch+github@mailbox.org"}, "subinamehta"=>{"name"=>"Subina Mehta", "email"=>"subinamehta@gmail.com"}, "tealiie"=>nil, "thomasmanke"=>{"name"=>"Thomas Manke"}, "timothygriffin"=>{"name"=>"Timothy J. Griffin", "email"=>"tgriffin@umn.edu", "github"=>false}, "tizzir"=>{"name"=>"Matthew Spelchak"}, "tnabtaf"=>{"name"=>"Dave Clements"}, "torhou"=>{"name"=>"Torsten Houwaart"}, "tseemann"=>{"name"=>"Torsten Seemann"}, "tklingstrom"=>{"name"=>"Tomas Klingstrom"}, "valentinmarcon"=>{"name"=>"Valentin Marcon"}, "vdda"=>{"name"=>"Victoria Dominguez del Angel"}, "vivekbhr"=>{"name"=>"Vivek Bhardwaj"}, "willdurand"=>{"name"=>"William Durand"}, "wm75"=>{"name"=>"Wolfgang Maier"}, "yhoogstrate"=>{"name"=>"Youri Hoogstrate"}, "yvanlebras"=>{"name"=>"Yvan Le Bras", "email"=>"yvan.le-bras@mnhn.fr", "twitter"=>"Yvan2935", "gitter"=>"yvanlebras", "orcid"=>"0000-0002-8504-068X"}})!
        </p>
        <p>
            Found a typo? Something is wrong in this tutorial? Edit it on
            <a href="https://github.com/galaxyproject/training-material/tree/master/topics/admin/tutorials/external-auth/tutorial.md">GitHub</a>.
        </p>
    </div>
</footer>

    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
</html>
