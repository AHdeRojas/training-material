---
layout: tutorial_slides
topic_name: phylogenetics
tutorial_name: GeneSeqToFamily
logo: "GTN"
---
GeneSeqToFamily

Discovery and Visualisation of Homologous Genes and Gene Families Using Galaxy

<small>[*Thanki et al., GigaScience, 2018*](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5863215/)</small>

---

### Gene family

- A gene family is a set of several similar genes
	- formed by duplication of a single original gene

- The study of homologous genes
	- Helps to understand the evolution of gene families

- Various tools available but they provide overview of homology at family level information
	- MSOAR, OrthoMCL, HomoloGene

- They can not provide information about structural changes within gene


---

### Ensembl GeneTree pipeline    

- The Ensembl GeneTrees computational pipeline 
	- Generates gene families based on coding sequences
	- Provides details about exon conservation

- It uses various tools: 
	- BLAST
	- hcluster_sg
	- T-Coffee
	- TreeBeST


<small>[*Vilella et al., Genome Research, 2009*](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2652215/)</small>

---

### Ensembl GeneTree pipeline    

- The Ensembl GeneTrees computational pipeline 
	- Generates gene families based on coding sequences
	- Provides details about exon conservation
- It uses various tools: 
	- BLAST
	- hcluster_sg
	- T-Coffee
	- TreeBeST

- Most tools are:
	- Specific to certain computing environments
	- Only usable via the command line
	- Require many dependencies to be fulfilled
	- Creates Ensembl Compara database for results



???

Slide notes
-> Pressing **P** will toggle presenter mode.


---

# GeneSeqToFamily

---

### GeneSeqToFamily

#### .left[Inputs]
	- CDS
	- GFF3/JSON
	- Species Tree

---

### GeneSeqToFamily Preparation

#### .left[Inputs]
	- CDS
	- GFF3/JSON

#### .left[Outputs]
	- Formatted CDS
	- SQLite (containing gene features)

.center[.image-75[![](../../images/GSTF/gstf_prep.png)]]
---

### GeneSeqToFamily Workflow

#### .left[Steps]
	- Translation
	- Pre-clustering Alignment
	- Cluster Generation
	- Cluster Alignment
	- Build GeneTree
	- Gene Alignments and Family Aggregator
	- Visualisation


---

### GeneSeqToFamily Workflow - Translation

- Translates CDS into Protein sequences using Transeq

.center[.image-75[![](../../images/GSTF/gstf_translate.png)]]

---

### GeneSeqToFamily Workflow - Pre-clustering Alignment

#### .left[BLASTP]
- Uses BLAST to create BLAST database
- Run BLASTP for protein sequences against the database

#### .left[BLAST Parser]
- BLAST parser converts 12/24 column BLAST result into 3 column input for hcluster_sg

.center[.image-75[![](../../images/GSTF/gstf_preclustering.png)]]

---

### GeneSeqToFamily Workflow - Cluster Generation

- Clusters are generated using hcluster_sg tool 

.center[.image-75[![](../../images/GSTF/gstf_clustering.png)]]
---

### GeneSeqToFamily Workflow - Cluster Alignment

- Multiple Sequence Alignemnt for each cluster is generated using T-Coffee with Muscle or MAFFT

.center[.image-75[![](../../images/GSTF/gstf_clusteraln.png)]]
---

### GeneSeqToFamily Workflow - Build GeneTree

- GeneTrees for each cluster is generated using TreeBeST 
- TreeBeST uses nucleotide sequence alignment, which is generated using Tranalign with input CDS and T-Coffee alignemnt.

.center[.image-75[![](../../images/GSTF/gstf_tree.png)]]
---

### GeneSeqToFamily Workflow - Gene Alignments and Family Aggregator

- Gene Alignments and Family Aggregator (GAFA) aggregates output of TreeBeST, T-Coffee and SQLite from GeneSeqToFamily Preparation

.center[.image-75[![](../../images/GSTF/gstf_gafa.png)]]
---

### GeneSeqToFamily Workflow - Visualisation

- Final results can be visualised within Galaxy using Aequatus Plugin.

.center[.image-75[![](../../images/GSTF/gstf_viz.png)]]
---
### GeneSeqToFamily Workflow - Visualisation

- Final results can be visualised within Galaxy using Aequatus Plugin.

.center[![](../../images/GSTF/gstf_result.png)]


