<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Galaxy Training!</title>
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <link rel="stylesheet" href="/training-material/assets/css/font-awesome.css">
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />
    </head>
    <body>
        




<header>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/topics/contributing" title="Go back to list of tutorials">
                            <i class="fa fa-folder-o" aria-hidden="true"></i><span class="visually-hidden">topic</span> Contributing to the Galaxy Training Material
                        </a>
                    </li>

                    
                        
                        
                        
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Introduction slides">
                                    <i class="fa fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> Introduction slides
                                </a>
                                <div class="dropdown-menu">
                                    
                                        
                                            
                                                <a class="dropdown-item" href="/training-material/topics/contributing/slides/introduction.html">
                                                    Overview of the Galaxy Training Material
                                                </a>
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                        
                                            
                                        
                                    
                                </div>
                            </li>
                        
                    

                    

                    

                    
                    <li class="nav-item">
                        <a class="nav-link" href="" title="Links to data">
                            <i class="fa fa-files-o" aria-hidden="true"></i><span class="visually-hidden">zenodo_link</span> Input Dataset
                        </a>
                    </li>
                    

                    

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="fa fa-life-ring" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu">
        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQ">
            FAQ
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Chat on Gitter">
            Gitter
        </a>
        <a class="dropdown-item" href="https://biostar.usegalaxy.org/" title="Ask on Biostars">
            Biostars
        </a>
    </div>
</li>


                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/galaxyproject/training-material/edit/master/topics/contributing/tutorials/create-new-tutorial-technical/tutorial.md">
                            <i class="fa fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="container main-content">
    <section class="tutorial">
        <h1>Creating a new tutorial - Defining the technical infrastructure</h1>

        <blockquote class="overview">
            <h3>Overview</h3>

            <strong><i class="fa fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</strong>
            <ul>
            
            <li>How can we define the technical infrastructure for a tutorial?</li>
            
            <li>How to define the tools needed for a tutorial?</li>
            
            <li>How to add the needed data directly in an instance?</li>
            
            <li>How to add the workflows related to a tutorial?</li>
            
            <li>How can we check the technical infrastructure is working?</li>
            
            <li>How can we make an existing Galaxy instance able to run a tutorial?</li>
            
            </ul>

            <strong><i class="fa fa-bullseye" aria-hidden="true"></i><span class="visually-hidden">objectives</span> Objectives</strong>
            <ul>
            
            <li>Extracting the technical description for a tutorial</li>
            
            <li>Populating an existing instance with the needed tools, data and workflows for a tutorial</li>
            
            <li>Creating a Galaxy Docker flavor with the needed tools, data and workflows for a tutorial</li>
            
            <li>Testing the Galaxy Docker flavor of a tutorial</li>
            
            </ul>

            

            <p><strong><i class="fa fa-hourglass-end" aria-hidden="true"></i><span class="visually-hidden">time</span> Time estimation:</strong> 30min</p>
        </blockquote>

        <h1 class="no_toc" id="building-a-galaxy-instance-specifically-for-your-training">Building a Galaxy instance specifically for your training</h1>

<p>To be able to run the tutorial, we need a Galaxy instance where all of the needed tools and data are available. Thus we need to describe the needed technical infrastructure.</p>

<p>This files we define in this tutorial will be used to automatically build a Docker Galaxy flavour, and also to test if a public Galaxy instance is able to run the tool.</p>

<p>In this tutorial, you will learn how to create a virtualised Galaxy instance, based on Docker, to run your training - either on normal computers or cloud environments.</p>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>In this tutorial, we will deal with:</p>

<ol id="markdown-toc">
  <li><a href="#extracting-workflows" id="markdown-toc-extracting-workflows">Extracting workflows</a></li>
  <li><a href="#creating-the-toolsyaml-recommended" id="markdown-toc-creating-the-toolsyaml-recommended">Creating the <code class="highlighter-rouge">tools.yaml</code> (recommended)</a></li>
  <li><a href="#creating-the-data-libraryyaml-recommended" id="markdown-toc-creating-the-data-libraryyaml-recommended">Creating the <code class="highlighter-rouge">data-library.yaml</code> (recommended)</a></li>
  <li><a href="#creating-the-data-manageryaml-optional" id="markdown-toc-creating-the-data-manageryaml-optional">Creating the <code class="highlighter-rouge">data-manager.yaml</code> (optional)</a></li>
  <li><a href="#creating-the-galaxy-interactive-tour-optional" id="markdown-toc-creating-the-galaxy-interactive-tour-optional">Creating the Galaxy Interactive Tour (optional)</a></li>
  <li><a href="#testing-the-technical-infrastructure" id="markdown-toc-testing-the-technical-infrastructure">Testing the technical infrastructure</a></li>
</ol>

</blockquote>

<h1 id="extracting-workflows">Extracting workflows</h1>

<p>Once the tutorial is ready, we need to develop a workflow that represents the steps taken in the tutorial, and then extract these workflow(s) and add them to the <code class="highlighter-rouge">workflows</code> directory in the tutorial. Additionally we will need to add some explanation about the workflow(s) in a <code class="highlighter-rouge">README.md</code> file</p>

<blockquote class="hands_on">
  <h3 id="hands_on-hands-on-extract-the-workflow"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Extract the workflow</h3>

  <ol>
    <li>Download the workflow for the tutorial</li>
    <li>Save it in the <code class="highlighter-rouge">workflow</code> directory of the tutorial</li>
    <li>Set <code class="highlighter-rouge">workflow</code> to <code class="highlighter-rouge">yes</code> in the appropriate section of the topic’s <code class="highlighter-rouge">metadata.yaml</code>.</li>
  </ol>
</blockquote>

<h1 id="creating-the-toolsyaml-recommended">Creating the <code class="highlighter-rouge">tools.yaml</code> (recommended)</h1>

<p>The first file to fill out is the <code class="highlighter-rouge">tools.yaml</code> file which contains the list of the required tools that could be installed from the ToolShed.</p>

<p>This file looks like:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">api_key</span><span class="pi">:</span> <span class="s">admin</span>
<span class="na">galaxy_instance</span><span class="pi">:</span> <span class="s">http://localhost:8080</span>
<span class="na">tools</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">tool1</span>
  <span class="na">owner</span><span class="pi">:</span> <span class="s">owner</span>
  <span class="na">tool_panel_section_label</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Section1"</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">tool2</span>
  <span class="na">owner</span><span class="pi">:</span> <span class="s">owner</span>
  <span class="na">tool_panel_section_label</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Section2"</span>
</code></pre></div></div>

<p>with:</p>

<ul>
  <li><code class="highlighter-rouge">name</code>: the name of the wrapper of the tool in the ToolShed</li>
  <li><code class="highlighter-rouge">owner</code>: the owner of the wrapper of the tool in the ToolShed</li>
  <li><code class="highlighter-rouge">tool_panel_section_label</code>: section where to put the tool (in the left panel in the Galaxy instance)</li>
</ul>

<p>This list of tools can be automatically extracted from the workflow using <a href="https://ephemeris.readthedocs.io/en/latest/index.html">Ephemeris</a> (which should be in the conda environment):</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> workflow-to-tools <span class="nt">-w</span> path/to/workflow <span class="nt">-o</span> path/to/tools.yaml
</code></pre></div></div>

<p>After the extraction, some formatting is needed:</p>

<ol>
  <li>
    <p>Add at the beginning:</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="s">---</span>
 <span class="s">api_key</span><span class="pi">:</span> <span class="s">admin</span>
 <span class="na">galaxy_instance</span><span class="pi">:</span> <span class="s">http://localhost:8080</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Change the <code class="highlighter-rouge">tool_panel_section_label</code> to something more informative</p>
  </li>
</ol>

<blockquote class="hands_on">
  <h3 id="hands_on-hands-on-creating-the-toolsyaml-from-your-workflow"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Creating the <code class="highlighter-rouge">tools.yaml</code> from your workflow</h3>

  <ol>
    <li>Create the <code class="highlighter-rouge">tools.yaml</code> file using your workflow and Ephemeris</li>
    <li>Correct the formatting of the <code class="highlighter-rouge">tools.yaml</code> file</li>
  </ol>
</blockquote>

<h1 id="creating-the-data-libraryyaml-recommended">Creating the <code class="highlighter-rouge">data-library.yaml</code> (recommended)</h1>

<p>The datasets needed for a tutorial can also be integrated in the Galaxy instance inside of data libraries. These allow the datasets to be easily shared with all users of a Galaxy instance. Additionally it lets trainees avoid each re-downloading the input data.</p>

<p>These datasets are described in the <code class="highlighter-rouge">data-library.yaml</code> files:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">libraries</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Name of the tutorial</span>
      <span class="na">files</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://raw.githubusercontent.com/bgruening/galaxytools/master/tools/rna_tools/sortmerna/test-data/read_small.fasta"</span>
          <span class="na">file_type</span><span class="pi">:</span> <span class="s">fasta</span>
        <span class="pi">-</span> <span class="na">url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
          <span class="na">file_type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
</code></pre></div></div>

<p>where:</p>

<ul>
  <li><code class="highlighter-rouge">name</code>: name of the tutorial, i.e. where to put the data in the data libraries</li>
  <li><code class="highlighter-rouge">files</code>: list of the files to download
    <ul>
      <li><code class="highlighter-rouge">url</code>: URL to the input file</li>
      <li><code class="highlighter-rouge">file-type</code>: type of the input file</li>
    </ul>
  </li>
</ul>

<p>The URL must refer to the URL of the files in <a href="https://zenodo.org">Zenodo</a>, do not just link to the overview page.</p>

<blockquote class="hands_on">
  <h3 id="hands_on-hands-on-creating-the-data-libraryyaml"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Creating the <code class="highlighter-rouge">data-library.yaml</code></h3>

  <ol>
    <li>Add the input files from your Zenodo dataset to the <code class="highlighter-rouge">data-library.yaml</code> file</li>
    <li>Add the link to Zenodo in the <code class="highlighter-rouge">metadata.yaml</code> file</li>
  </ol>
</blockquote>

<h1 id="creating-the-data-manageryaml-optional">Creating the <code class="highlighter-rouge">data-manager.yaml</code> (optional)</h1>

<p>Some of the tools may require specific databases, specifically prepared for the tool. In this case, some Galaxy tools come with “data managers” to simplify this process.</p>

<p>If you need such data managers for your training, then you should describe how to run them in the <code class="highlighter-rouge">data-manager.yaml</code> file:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">data_managers</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">url to data manager on ToolShed</span>
      <span class="na">params</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s1">'</span><span class="s">param1'</span><span class="pi">:</span> <span class="s1">'</span><span class="s">'</span>
        <span class="pi">-</span> <span class="s1">'</span><span class="s">param2'</span><span class="pi">:</span> <span class="s1">'</span><span class="s">value'</span>
      <span class="c1"># Items refer to a list of variables you want to run this data manager. You can use them inside the param field with </span>
      <span class="c1"># In case of genome for example you can run this DM with multiple genomes, or you could give multiple URLs.</span>
      <span class="na">items</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">item1</span>
        <span class="pi">-</span> <span class="s">item2</span>
      <span class="c1"># Name of the data-tables you want to reload after your DM are finished. This can be important for subsequent data managers</span>
      <span class="na">data_table_reload</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">all_fasta</span>
        <span class="pi">-</span> <span class="s">__dbkeys__</span>
</code></pre></div></div>

<h1 id="creating-the-galaxy-interactive-tour-optional">Creating the Galaxy Interactive Tour (optional)</h1>

<p>A Galaxy Interactive Tour is a way to go through an entire analysis, step by step inside Galaxy in an interactive and explorative way.
It is a great way to help users run the tutorial directly inside Galaxy. To learn more about creating a Galaxy tour please have a look at our <a href="/training-material/topics/contributing/tutorials/create-new-tutorial-tours/tutorial.html">dedicated tour training</a>.</p>

<h1 id="testing-the-technical-infrastructure">Testing the technical infrastructure</h1>

<p>Once we have defined all the requirements for running the tutorial, we can test these requirements, either in a locally running Galaxy or in a Docker container. Please see our tutorial about <a href="/training-material/topics/contributing/tutorials/setup-galaxy-for-training/tutorial.html">Setting up Galaxy for Training</a> about how to test your tutorial requirements.</p>

<h1 class="no_toc" id="conclusion">Conclusion</h1>


        
        <blockquote class="key_points">
            <h3><i class="fa fa-key" aria-hidden="true"></i><span class="visually-hidden">keypoints</span> Key points</h3>

            <ul>
                
                <li>Tools, data and workflows can be easily integrated in a Docker flavor to have a useful technical support for a tutorial</li>
                
                <li>A Galaxy Docker flavor is a great support for training</li>
                
                <li>A Galaxy Docker flavor can be deployed 'anywhere' and is scalable</li>
                
            </ul>
        </blockquote>
        

        

        
        <blockquote class="agenda">
            <h3>Developing GTN training material</h3>
            This tutorial is part of a series to develop GTN training material, feel free to also look at:
            
            <ol>
            
             
              
            <li><a href="/training-material/topics/contributing/slides/introduction.html">Overview of the Galaxy Training Material</a></li>
             
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/github-interface-contribution/tutorial.html">Contributing with GitHub via its interface</a></li>
              
              
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/github-command-line-contribution/tutorial.html">Contributing with GitHub via command-line</a></li>
              
              
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/create-new-tutorial/tutorial.html">Creating a new tutorial</a></li>
              
              
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/create-new-tutorial-content/tutorial.html">Creating a new tutorial - Writing content in Markdown</a></li>
              
              
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/create-new-tutorial-metadata/tutorial.html">Creating a new tutorial - Defining metadata</a></li>
              
              
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/create-new-tutorial-tours/tutorial.html">Creating a new tutorial - Creating Interactive Galaxy Tours</a></li>
              
              
             
            
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/create-new-tutorial-slides/slides.html">Creating a new tutorial - Slides</a></li>
               
              
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/create-new-topic/tutorial.html">Including a new topic</a></li>
              
              
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/running-jekyll/tutorial.html">Running the Galaxy Training material website locally</a></li>
              
              
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/generating-pdf/tutorial.html">Generating PDF artefacts of the website</a></li>
              
              
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/good-practices/slides.html">Good practices to run a workshop</a></li>
               
              
             
            
             
              
              
            <li><a href="/training-material/topics/contributing/tutorials/setup-galaxy-for-training/tutorial.html">Set up a Galaxy for Training</a></li>
              
              
             
            
             </ol>
        </blockquote>
        

        <h3><i class="fa fa-thumbs-up" aria-hidden="true"></i><span class="visually-hidden">congratulations</span> Congratulations on successfully completing this tutorial!</h3>

        <hr>

        <blockquote class="overview">
            <h3><i class="fa fa-comments-o" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Help us improve this content!</h3>
            Please take a moment to fill in the Galaxy Training Network
            <a href="https://tinyurl.com/GTNfeedback">Feedback Form</a>.
            Your feedback helps us improve this tutorial and will be considered
            in future revisions.
        </blockquote>
    </section>
</div>


<footer>
    <div class="container">
        <p>
            This material is the result of a collaborative work. Thanks to the
            <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a>
            and all the <a href="/training-material/hall-of-fame">contributors</a> (Bérénice Batut, Björn Grüning, Saskia Hiltemann)!
        </p>
        <p>
            Found a typo? Something is wrong in this tutorial? Edit it on
            <a href="https://github.com/galaxyproject/training-material/tree/master/topics/contributing/tutorials/create-new-tutorial-technical/tutorial.md">GitHub</a>.
        </p>
    </div>
</footer>

    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
</html>
