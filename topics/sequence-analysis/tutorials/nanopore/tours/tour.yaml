id: nanopore
name: Nanopore Tour
description: In this tour we will perform an assembly of nanopore data and show some of the possible analysis tools.
title_default: nanopore
steps:
steps:
  - title: Nanopore Sequence Analysis
    content: >-
      In this tour we will perform an assembly of nanopore data and show some of the possible analysis tools.
    backdrop: true
  - title: Nanopore Sequence Analysis
    content: >-
      In this tutorial we use metagenomic nanopore data, but similar pipelines can be used for Illumina data.<br><br>
      Nanopore sequencing has serveral properties that make it more suited for our purposes: <ol>
        <li>Long-read sequencing technology offers simplified and less ambiguous genome assembly</li>
        <li>Long-read sequencing gives the ability to span repetitive genomic regions</li>
        <li>Long-read sequencing makes it possible to identify large structural variation</li>
      </ol>
    backdrop: true
  - title: Understanding our input data
    content: >-
As training data we use a sing plasmid from a dataset (,created by Li, Ruichao et al.) used for evaluation of the efficiency of MDR plasmid sequencing by MinION platform. In the experiment 12 MDR plasmid-bearing strains were selected for plasmid extraction, including E. coli, S. typhimurium, V. parahaemolyticus, and K. pneumoniae. Overnight cultures (100 mL) were harvested and subjected to plasmid extraction using the QIAGEN Plasmid Midi Kit. The extracted plasmids were dissolved in ultrapure distilled water, and concentrations were measured by Qubit 3.0 Fluorometer with a dsDNA BR Assay Kit. The plasmids were stored in –20°C until library preparation.

Library preparation was performed using the Rapid Barcoding Sequencing Kit (SQK-RBK001) according to the standard protocol provided by the manufacturer (Oxford Nanopore). Briefly, 7.5-μL plasmid templates were combined with a 2.5-μL Fragmentation Mix Barcode (1 barcode for each sample). The mixtures were incubated at 30°C for 1 minute and at 75°C for 1 minute. The barcoded libraries were pooled together with designated ratios in 10 μL; 1 μL of RAD (Rapid 1D Adapter) was added to the pooled library and mixed gently; 0.2 μL of Blunt/TA Ligase Master Mix was added and incubated for 5 minutes at room temperature. The constructed library was loaded into the Flow Cell R9.4 (FLO-MIN106) on a MinION device and run with the SQK-RBK001_plus_Basecaller script of MinKNOW1.5.12 software. The run was stopped after 8 hours, and the flow cell was washed by a Wash Kit (EXP-WSH002) and stored in 4°C for later use.

To obtain high-quality short read data, paired-end (2 × 150 bp) libraries were prepared by the focused acoustic shearing method with the NEBNext Ultra DNA Library Prep Kit and the Multiplex Oligos Kit for Illumina (NEB). The libraries were quantified by employing quantitative PCR with P5-P7 primers, and they were pooled together and sequenced on the NextSeq 500 platform according to the manufacturer’s protocol (Illumina).

Although a local basecaller script was used during the run, there was still a small amount of reads that were not basecalled due to the generation of raw data in a rapid mode. Albacore basecalling software (v1.0.3) was used to generate fast5 files harboring the 1D DNA sequence from fast5 files with only raw data in the tmp folder. Also, the read_fast5_basecaller.py script in Albacore was used to de-multiplex the 12 samples from basecalled fast5 files (except the files in fail folder) based on the 12 barcodes in SQK-RBK001. The Poretools toolkit was utilized to extract all the DNA sequences from fast5 to fasta format among the 12 samples, respectively (Poretools, RRID:SCR_015879).
    backdrop: true
  - title: Dataset details
    content: >-
      Because of the large size of the original datasets (1.15 GB) you are given 1 of the 12 plasmids files.

This sequence file is 51 MB of nanopore sequences. The 10026 reads found in this file contain 49190798 nucleotides. As mentioned before nanopore sequences are long reads and this is confirmed by a mean read length of 4906.3.
    backdrop: true
  - title: History options
    element: '#history-options-button'
    content: >-
      We will start the analyses by creating a new history. Click on this button
      and then "Create New". Give it a name.
    placement: left
    backdrop: false
  - title: Import sample data
    element: >-
      #current-history-panel .empty-message.infomessagesmall
      a[href$="javascript:void(0)"]
    content: ''
    placement: left
  - title: Import Sample Data
    element: '#regular .upload-view-default .upload-box input'
    content: ''
    placement: right
  - title: Import Sample Data
    element: '#btn-local'
    content: ''
    placement: right
  - title: Import Sample Data
    element: '#btn-start'
    content: ''
    placement: left
  - title: Import Sample Data
    element: '#btn-close'
    content: ''
    placement: left
  - title: Plotting scripts for long read sequencing data
    element: '#tool-search'
    content: ''
    placement: right
    postclick:
      - >-
        a[href$="/galaxy/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fiuc%2Fnanoplot%2Fnanoplot%2F1.13.0"]
        .tool-old-link
  - title: View read length histogram
    element: >-
      #dataset-a22a75f0ac628260 .primary-actions
      a[href$="/galaxy/datasets/a22a75f0ac628260/display/?preview=True"]
      .fa.fa-eye
    content: ''
    placement: left
  - title: Pairwise sequence alignment
    element: '#tool-search'
    content: ''
    placement: right
    postclick:
      - >-
        a[href$="/galaxy/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fiuc%2Fminimap2%2Fminimap2%2F2.12"]
        .tool-old-link
  - title: De novo assembly
    element: '#tool-search'
    content: ''
    placement: right
    postclick:
      - >-
        a[href$="/galaxy/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Ferasmus-medical-center%2Fminiasm%2Fminiasm%2F0.2.0"]
        .tool-old-link
  - title: GFA to Fasta
    element: '#tool-search'
    content: ''
    placement: right
    postclick:
      - >-
        a[href$="/galaxy/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Ferasmus-medical-center%2Fgfa_to_fa%2Fgfa_to_fa%2F0.1.0"]
        .tool-old-link
  - title: Pairwise sequence alignment
    element: '#tool-search'
    content: ''
    placement: right
    postclick:
      - >-
        a[href$="/galaxy/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fiuc%2Fminimap2%2Fminimap2%2F2.12"]
        .tool-old-link
  - title: Consensus module
    element: '#tool-search'
    content: ''
    placement: right
    postclick:
      - >-
        a[href$="/galaxy/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Fracon%2Fracon%2F1.3.1.1"]
        .tool-old-link
  - title: Prediction of plasmid sequences
    element: '#tool-search'
    content: ''
    placement: right
    postclick:
      - >-
        a[href$="/galaxy/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fiuc%2Fplasflow%2FPlasFlow%2F1.0"]
        .tool-old-link
  - title: Visualising de novo assembly graphs
    element: '#tool-search'
    content: ''
    placement: right
    postclick:
      - >-
        a[href$="/galaxy/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fiuc%2Fbandage%2Fbandage_image%2F0.8.1%2Bgalaxy0"]
        .tool-old-link
  - title: Prediction of AMR genes
    element: '#tool-search'
    content: ''
    placement: right
    postclick:
      - >-
        a[href$="/galaxy/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fnml%2Fstaramr%2Fstaramr_search%2F0.2.2"]
        .tool-old-link
